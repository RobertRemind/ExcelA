<!DOCTYPE html>
<html>
<head>
    <title>Excel Add-in</title>
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script type="text/javascript" src="https://kind-hill-08927eb00.4.azurestaticapps.net/taskpane.js"></script>
    <script type="text/javascript" src="https://kind-hill-08927eb00.4.azurestaticapps.net/functions.js"></script>    
    
</head>
<body>
    <h1>Hello Excel Add-in!</h1>

    <p>
        <div role="button" id="run" class="ms-welcome__action ms-Button ms-Button--hero ms-font-xl">
            <span class="ms-Button-label">Run</span>
        </div>
    </p>

    <ul>
        <li>
            See example on the Script lab called <b><a href="#">Data Types: Create Entity Types from data in Data Table.</a></b>
            The aim here would be to load Dimensional data (ie. Product, customer, store) into memory as array like the sample does:        
            <code>
                const products = [
                    {
                    productID: 1,
                    productName: "Chai",
                    supplierID: 1,
                    categoryID: 1,
                    quantityPerUnit: "10 boxes x 20 bags",
                    unitPrice: 18,
                    discontinued: false,
                    productImage: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Masala_Chai.JPG/320px-Masala_Chai.JPG"
                    }, 
                    ...
                ]
            </code>

            It's possible that the array could be loaded from the DB only if it is listed a table. That many be preferable to loading the whole dimension every time. Some kind of <i>Dimension Count</i> function maybe required.        
            <br/>
        </li>
        <li>
            <p>The is a sample <a href="#">Import Json Data</a> that shows how to import data into a table from JSON. If the source is JSON why would we transform to SQL then back to JSON to transform the data? It's probably smarter to manage in code the format of dimension / measure's JSON.</p>
        </li>
        
        <li>
            <p>The is a sample <a href="#">Data Types: Custom functions</a> shows how to create a function that return all the data that matched a specific query/filter set. This would be useful for reporting. </p>
            <code> 
                /**
                * Search for products that match a given substring. Try =SCRIPTLAB.DATATYPESCUSTOMFUNCTIONS.PRODUCTSEARCH("chef", false).
                * @customfunction
                * @param {string} query The string to search for in the sample JSON data.
                * @param {boolean} [completeMatch] Define whether the search should be a match of the whole product name or part of the product name. If omitted, completeMatch = false.
                * @return {Promise<any[][]>} Search results as one or more data type entity values.
                */
                async function productSearch(query: string, completeMatch?: boolean): Promise<any[][]> {
                    ....
            </code>
        </li>
            <p><a href="#">Data Types: Custom functions</a> shows how format a cell based on the data type of the contents.</p>
        <li>
            <p><a href="#">Data Types: Create Entity Icons</a> has a list of all the icons available to be shown next to a data entity - Planes, Trans, and automobiles - Each Dimension could be tagged with it's own icon. </p>
        </li>
        <li>
            <p><a href="#">Data Types: Entity Value Attribution Properties</a> Allows you to display the source of a data point as an icon on the bottom of a data card. If the solution expand to multiple datasources it will be useful identitify which one.</p>
        </li>
        <li>
            <p><a href="#">Hyperlinks</a> shows how to create a cell hyperlink which will be useful for deep linking data sources. For example, it would be possible to deep link from a product to the Shopify Product admin page. </p>
        </li>

        <li>
            <p><a href="#">Report Generation</a> has an example of how to build up a report with a data table and chart.</p>
        </li>
        

    </ul>


</body>
</html>
